<!DOCTYPE html>
<!--
  ~ /* ------------------------------------------------------------------------------------
  ~  * Copyright (c) SAS Institute Inc.
  ~  *  Licensed under the Apache License, Version 2.0 (the "License");
  ~  * you may not use this file except in compliance with the License.
  ~  * You may obtain a copy of the License at
  ~  *
  ~  * http://www.apache.org/licenses/LICENSE-2.0
  ~  *
  ~  *  Unless required by applicable law or agreed to in writing, software
  ~  * distributed under the License is distributed on an "AS IS" BASIS,
  ~  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  * See the License for the specific language governing permissions and
  ~ * limitations under the License.
  ~ ----------------------------------------------------------------------------------------*/
  ~
  -->

<html lang="en">
<head>
    <meta charset="UTF-8">

    <script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.min.js"></script>
    <script src="https://unpkg.com/restaf@dev/dist/restaf.min.js"></script>
    <script src="/appenv"></script>

   

    <style>
        .container {
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
            min-height: 800px;
        }
        .elabel{
            display: inline-block;
        
            clear: left;
            width: 250px;
            text-align: right;
        }
        .einput {
            display: inline-block;
           
        }
        .div1 {
            border: 1px solid black;
            background: lightskyblue;

        }
        .div2 {
            border: 1px solid black;
            background: lightskyblue;
            height: 200px;
        }
    </style>
<script>
    let store   = restaf.initStore();
    let session = null;
    let servers = null;
    let services = null;
    let files = null;
    let reports = null;
    function setup() {
        debugger;
        initSession() 
        .then ( r => {
            document.getElementById('head').innerHTML = LOGONPAYLOAD.authType;
            console.log(r)
        })
        .catch( e => {
           
            console.log(e)
        })
        }
    async function initSession() {
        debugger;
        console.log(LOGONPAYLOAD);
        let msg = await store.logon(LOGONPAYLOAD);
        debugger;
        services = await store.addServices('files', 'compute', 'casManagement');
        debugger;
        console.log((JSON.stringify(services.casManagement.links(), null, 4)));
        let casManagement = services.casManagement;
        let servers = await store.apiCall(casManagement.links('servers'));
        let payload = { data: { name: 'astore' } };
        let serverName = servers.itemsList(0);
        let session = await store.apiCall(servers.itemsCmd(serverName, 'createSession'), payload);
        return 'done';
    }
    function runit(type) {
        console.log('calling reports');
        debugger;
        
        store.apiCall(services.files.links('files'))
        .then (r => {
            debugger;
            console.log(JSON.stringify(r.items(), null,4));
            console.log('reports done');
        })
        .catch(err => alert(err));
    }

</script>
</head>
<body onload="setup()">
<h1 id="head"> Hi proxy</h1>
<div>
        <button  onclick="runit('files')"> Press to make a call to file service</button>
        <br>

        <button onclick="runit('compute')"> Press to make a call compute service</button>
        <br>

        <button onclick="runit('casManagement')"> Press to make a call compute service</button>
        <br>

        

</div>
</body>
</html>